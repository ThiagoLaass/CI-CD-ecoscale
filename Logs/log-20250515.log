2025-05-15 19:49:47.318 -03:00 [ERR] An error occurred using the connection to database 'ecoscale' on server 'tcp://localhost:5432'.
2025-05-15 19:49:48.002 -03:00 [INF] Executed DbCommand (433ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE DATABASE ecoscale;
2025-05-15 19:49:48.159 -03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-05-15 19:49:48.182 -03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-05-15 19:49:48.189 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-05-15 19:49:48.202 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-05-15 19:49:48.216 -03:00 [INF] Applying migration '20250515013322_fix'.
2025-05-15 19:49:48.248 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE email_confirmacao (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    num_codigo text NOT NULL,
    boo_confirmado boolean NOT NULL,
    boo_excluido boolean NOT NULL,
    ref_id text NOT NULL,
    expires_at timestamp with time zone NOT NULL,
    created_at timestamp with time zone NOT NULL,
    CONSTRAINT "PK_email_confirmacao" PRIMARY KEY ("Id")
);
2025-05-15 19:49:48.258 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE notificacao (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    mensagem text NOT NULL,
    boo_lida boolean NOT NULL,
    ref_id text NOT NULL,
    expires_at timestamp with time zone NOT NULL,
    created_at timestamp with time zone NOT NULL,
    CONSTRAINT "PK_notificacao" PRIMARY KEY ("Id")
);
2025-05-15 19:49:48.266 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE responsavel_empresa (
    responsavel_empresa_id integer GENERATED BY DEFAULT AS IDENTITY,
    nome text NOT NULL,
    telefone text NOT NULL,
    cpf text NOT NULL,
    CONSTRAINT "PK_responsavel_empresa" PRIMARY KEY (responsavel_empresa_id)
);
2025-05-15 19:49:48.278 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Usuarios" (
    usuario_id integer GENERATED BY DEFAULT AS IDENTITY,
    email text NOT NULL,
    senha text NOT NULL,
    boo_email_confirmado boolean NOT NULL,
    CONSTRAINT "PK_Usuarios" PRIMARY KEY (usuario_id)
);
2025-05-15 19:49:48.290 -03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE moderador (
    usuario_id integer NOT NULL,
    nome text NOT NULL,
    CONSTRAINT "PK_moderador" PRIMARY KEY (usuario_id),
    CONSTRAINT "FK_moderador_Usuarios_usuario_id" FOREIGN KEY (usuario_id) REFERENCES "Usuarios" (usuario_id) ON DELETE CASCADE
);
2025-05-15 19:49:48.299 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE empresa (
    usuario_id integer NOT NULL,
    cnpj text NOT NULL,
    razao_social text NOT NULL,
    num_telefone text NOT NULL,
    endereco_sede text NOT NULL,
    foto_perfil bytea,
    dsc_empresa text,
    setor_atuacao text NOT NULL,
    boo_removida boolean NOT NULL,
    responsavel_id integer NOT NULL,
    moderador_id integer,
    CONSTRAINT "PK_empresa" PRIMARY KEY (usuario_id),
    CONSTRAINT "FK_empresa_Usuarios_usuario_id" FOREIGN KEY (usuario_id) REFERENCES "Usuarios" (usuario_id) ON DELETE CASCADE,
    CONSTRAINT "FK_empresa_moderador_moderador_id" FOREIGN KEY (moderador_id) REFERENCES moderador (usuario_id),
    CONSTRAINT "FK_empresa_responsavel_empresa_responsavel_id" FOREIGN KEY (responsavel_id) REFERENCES responsavel_empresa (responsavel_empresa_id) ON DELETE CASCADE
);
2025-05-15 19:49:48.309 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE questionario (
    questionario_id integer GENERATED BY DEFAULT AS IDENTITY,
    boo_excluido boolean NOT NULL,
    empresa_cnpj integer NOT NULL,
    CONSTRAINT "PK_questionario" PRIMARY KEY (questionario_id),
    CONSTRAINT "FK_questionario_empresa_empresa_cnpj" FOREIGN KEY (empresa_cnpj) REFERENCES empresa (usuario_id) ON DELETE CASCADE
);
2025-05-15 19:49:48.320 -03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE relatorio (
    relatorio_id integer GENERATED BY DEFAULT AS IDENTITY,
    empresa_cnpj integer NOT NULL,
    dsc_sustentabilidade text NOT NULL,
    dsc_melhorias text NOT NULL,
    boo_revisado boolean NOT NULL,
    "RevisorId" integer,
    CONSTRAINT "PK_relatorio" PRIMARY KEY (relatorio_id),
    CONSTRAINT "FK_relatorio_empresa_empresa_cnpj" FOREIGN KEY (empresa_cnpj) REFERENCES empresa (usuario_id) ON DELETE CASCADE,
    CONSTRAINT "FK_relatorio_moderador_RevisorId" FOREIGN KEY ("RevisorId") REFERENCES moderador (usuario_id)
);
2025-05-15 19:49:48.333 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE area (
    area_id integer GENERATED BY DEFAULT AS IDENTITY,
    nom_area text NOT NULL,
    questionario_id integer,
    CONSTRAINT "PK_area" PRIMARY KEY (area_id),
    CONSTRAINT "FK_area_questionario_questionario_id" FOREIGN KEY (questionario_id) REFERENCES questionario (questionario_id)
);
2025-05-15 19:49:48.345 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE tema (
    tema_id integer GENERATED BY DEFAULT AS IDENTITY,
    nom_tema text NOT NULL,
    area_id integer,
    CONSTRAINT "PK_tema" PRIMARY KEY (tema_id),
    CONSTRAINT "FK_tema_area_area_id" FOREIGN KEY (area_id) REFERENCES area (area_id)
);
2025-05-15 19:49:48.352 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE criterio (
    criterio_id integer GENERATED BY DEFAULT AS IDENTITY,
    nom_criterio text NOT NULL,
    tema_id integer,
    CONSTRAINT "PK_criterio" PRIMARY KEY (criterio_id),
    CONSTRAINT "FK_criterio_tema_tema_id" FOREIGN KEY (tema_id) REFERENCES tema (tema_id)
);
2025-05-15 19:49:48.358 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE item_avaliado (
    item_id integer GENERATED BY DEFAULT AS IDENTITY,
    dsc_item text NOT NULL,
    resposta text,
    criterio_id integer,
    CONSTRAINT "PK_item_avaliado" PRIMARY KEY (item_id),
    CONSTRAINT "FK_item_avaliado_criterio_criterio_id" FOREIGN KEY (criterio_id) REFERENCES criterio (criterio_id)
);
2025-05-15 19:49:48.362 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_area_questionario_id" ON area (questionario_id);
2025-05-15 19:49:48.371 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_criterio_tema_id" ON criterio (tema_id);
2025-05-15 19:49:48.377 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_empresa_moderador_id" ON empresa (moderador_id);
2025-05-15 19:49:48.382 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_empresa_responsavel_id" ON empresa (responsavel_id);
2025-05-15 19:49:48.388 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_item_avaliado_criterio_id" ON item_avaliado (criterio_id);
2025-05-15 19:49:48.391 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_questionario_empresa_cnpj" ON questionario (empresa_cnpj);
2025-05-15 19:49:48.394 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_relatorio_empresa_cnpj" ON relatorio (empresa_cnpj);
2025-05-15 19:49:48.397 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_relatorio_RevisorId" ON relatorio ("RevisorId");
2025-05-15 19:49:48.401 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_tema_area_id" ON tema (area_id);
2025-05-15 19:49:48.407 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20250515013322_fix', '9.0.3');
2025-05-15 19:49:48.409 -03:00 [INF] Applying migration '20250515014534_fix_'.
2025-05-15 19:49:48.424 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE empresa DROP CONSTRAINT "FK_empresa_Usuarios_usuario_id";
2025-05-15 19:49:48.427 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE moderador DROP CONSTRAINT "FK_moderador_Usuarios_usuario_id";
2025-05-15 19:49:48.429 -03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Usuarios" DROP CONSTRAINT "PK_Usuarios";
2025-05-15 19:49:48.432 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Usuarios" RENAME TO usuario;
2025-05-15 19:49:48.436 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE usuario ADD CONSTRAINT "PK_usuario" PRIMARY KEY (usuario_id);
2025-05-15 19:49:48.444 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE empresa ADD CONSTRAINT "FK_empresa_usuario_usuario_id" FOREIGN KEY (usuario_id) REFERENCES usuario (usuario_id) ON DELETE CASCADE;
2025-05-15 19:49:48.447 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE moderador ADD CONSTRAINT "FK_moderador_usuario_usuario_id" FOREIGN KEY (usuario_id) REFERENCES usuario (usuario_id) ON DELETE CASCADE;
2025-05-15 19:49:48.450 -03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20250515014534_fix_', '9.0.3');
2025-05-15 20:49:14.868 -03:00 [INF] Swagger UI available at http://localhost:5051/swagger/index.html
2025-05-15 20:49:14.941 -03:00 [INF] Server starting and listening on http://0.0.0.0:5051
2025-05-15 20:49:14.954 -03:00 [INF] User profile is available. Using 'C:\Users\thiag\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-15 20:49:15.020 -03:00 [INF] Now listening on: http://0.0.0.0:5051
2025-05-15 20:49:15.022 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-15 20:49:15.023 -03:00 [INF] Hosting environment: Development
2025-05-15 20:49:15.024 -03:00 [INF] Content root path: C:\Repos\pmg-es-2025-1-ti4-3170100-pesquisa-bh-tec\Codigo\backend\EcoScale
2025-05-15 20:49:19.676 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/index.html - null null
2025-05-15 20:49:20.282 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/index.html - 200 null text/html;charset=utf-8 610.6524ms
2025-05-15 20:49:20.439 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/index.css - null null
2025-05-15 20:49:20.439 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui.css - null null
2025-05-15 20:49:20.439 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui-bundle.js - null null
2025-05-15 20:49:20.503 -03:00 [INF] Sending file. Request path: '/index.css'. Physical path: 'N/A'
2025-05-15 20:49:20.505 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/index.css - 200 202 text/css 65.3598ms
2025-05-15 20:49:20.507 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui-standalone-preset.js - null null
2025-05-15 20:49:20.580 -03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-05-15 20:49:20.583 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui.css - 200 154948 text/css 143.8785ms
2025-05-15 20:49:20.594 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/index.js - null null
2025-05-15 20:49:20.601 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/index.js - 200 null application/javascript;charset=utf-8 7.3577ms
2025-05-15 20:49:20.624 -03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-05-15 20:49:20.626 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui-standalone-preset.js - 200 229223 text/javascript 118.6502ms
2025-05-15 20:49:21.322 -03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-05-15 20:49:21.324 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui-bundle.js - 200 1466324 text/javascript 884.7816ms
2025-05-15 20:49:21.513 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/v1/swagger.json - null null
2025-05-15 20:49:21.562 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/favicon-32x32.png - null null
2025-05-15 20:49:21.565 -03:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-05-15 20:49:21.566 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/favicon-32x32.png - 200 628 image/png 3.9994ms
2025-05-15 20:49:21.694 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 180.4379ms
2025-05-15 20:49:28.728 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/index.html - null null
2025-05-15 20:49:28.731 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/index.html - 200 null text/html;charset=utf-8 2.9186ms
2025-05-15 20:49:28.811 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui.css - null null
2025-05-15 20:49:28.811 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/index.css - null null
2025-05-15 20:49:28.812 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui-bundle.js - null null
2025-05-15 20:49:28.812 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui-standalone-preset.js - null null
2025-05-15 20:49:28.813 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/index.js - null null
2025-05-15 20:49:28.814 -03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-05-15 20:49:28.816 -03:00 [INF] Sending file. Request path: '/index.css'. Physical path: 'N/A'
2025-05-15 20:49:28.823 -03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-05-15 20:49:28.823 -03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-05-15 20:49:28.825 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/index.js - 200 null application/javascript;charset=utf-8 12.47ms
2025-05-15 20:49:28.826 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui.css - 200 154948 text/css 15.3622ms
2025-05-15 20:49:28.828 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/index.css - 200 202 text/css 16.3579ms
2025-05-15 20:49:28.829 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui-bundle.js - 200 1466324 text/javascript 17.1003ms
2025-05-15 20:49:28.830 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/swagger-ui-standalone-preset.js - 200 229223 text/javascript 17.7964ms
2025-05-15 20:49:28.950 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/favicon-32x32.png - null null
2025-05-15 20:49:28.952 -03:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-05-15 20:49:28.953 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/favicon-32x32.png - 200 628 image/png 3.2475ms
2025-05-15 20:49:28.971 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/v1/swagger.json - null null
2025-05-15 20:49:28.980 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 8.8449ms
2025-05-15 20:52:17.503 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5051/swagger/v1/swagger.json - null null
2025-05-15 20:52:17.522 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5051/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 18.9064ms
2025-05-15 21:44:06.600 -03:00 [INF] Application is shutting down...
